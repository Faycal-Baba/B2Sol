THEORY User_Pass IS
Operation(Initialisation) & ff(0) & dd & ah(dom(ADDRESS*{0}) = ADDRESS) & dd & eh(dom(ADDRESS*{0}),ADDRESS,Goal) & pr & ar(s1.5,Goal) & pr;
Operation(withdraw) & ff(0) & dd & ah(dom(accountOf<+{msg_sender|->accountOf(msg_sender)-amount}) = dom(accountOf)) & ss & pr & dd & eh(dom(accountOf<+{msg_sender|->accountOf(msg_sender)-amount}),dom(accountOf),Goal) & ah((balanceOf<+{THIS|->balanceOf(THIS)-amount,msg_sender|->balanceOf(msg_sender)+amount})(THIS) = balanceOf(THIS)-amount) & ah(THIS : dom({THIS|->balanceOf(THIS)-amount,msg_sender|->balanceOf(msg_sender)+amount})) & ss & pr & dd & pr & dd & eh((balanceOf<+{THIS|->balanceOf(THIS)-amount,msg_sender|->balanceOf(msg_sender)+amount})(THIS),balanceOf(THIS)-amount,Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}\/{msg_sender}) & ss & pr & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}\/{msg_sender},Goal) & ah(accountOf<+{msg_sender|->accountOf(msg_sender)-amount} = {msg_sender}<<|accountOf\/{msg_sender|->accountOf(msg_sender)-amount}) & ar(b1.38,Once) & dd & eh(accountOf<+{msg_sender|->accountOf(msg_sender)-amount},{msg_sender}<<|accountOf\/{msg_sender|->accountOf(msg_sender)-amount},Goal) & ah(dom(accountOf)-{msg_sender}/\{msg_sender} = {}) & pr & dd & ah({msg_sender}<<|accountOf : dom(accountOf)-{msg_sender} +-> NATURAL) & ar(InFunctionXY.10,Once) & pr & ah(ran({msg_sender}<<|accountOf) <: NAT & NAT <: NATURAL) & pr & pr & pr & dd & ar(s1.3,Goal) & ah(msg_sender/:dom(accountOf)-{msg_sender}) & pr & dd & ar(SimplifyIntSIGXY.3,Goal) & ar(SimplifyIntSIGXY.12,Goal) & eh(THIS,THIS,Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}\/{msg_sender}) & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}\/{msg_sender},Hyp(balanceOf(THIS) = SIGMA(ct).(ct : dom(accountOf) | accountOf(ct))+initial_balance)) & dd & eh(balanceOf(THIS),SIGMA(ct).(ct : dom(accountOf)-{msg_sender}\/{msg_sender} | accountOf(ct))+initial_balance,Goal) & ar(s1.3,Goal) & pr;
Operation(deposit) & ff(0) & dd & ah(dom(accountOf<+{msg_sender|->accountOf(msg_sender)+msg_value}) = dom(accountOf)) & ss & pr & dd & eh(dom(accountOf<+{msg_sender|->accountOf(msg_sender)+msg_value}),dom(accountOf),Goal) & ah(accountOf<+{msg_sender|->accountOf(msg_sender)+msg_value} = {msg_sender}<<|accountOf\/{msg_sender|->accountOf(msg_sender)+msg_value}) & ar(b1.38,Once) & dd & eh(accountOf<+{msg_sender|->accountOf(msg_sender)+msg_value},{msg_sender}<<|accountOf\/{msg_sender|->accountOf(msg_sender)+msg_value},Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}\/{msg_sender}) & ss & pr & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}\/{msg_sender},Goal) & ah(dom(accountOf)-{msg_sender}/\{msg_sender} = {}) & ss & pr & dd & ar(s1.3,Goal) & ah({msg_sender}<<|accountOf : dom(accountOf)-{msg_sender} +-> NATURAL) & ar(InFunctionXY.10,Once) & pr & ah(ran({msg_sender}<<|accountOf) <: NAT & NAT <: NATURAL) & pr & pr & pr & dd & ah(msg_sender/:dom(accountOf)-{msg_sender}) & pr & dd & ar(SimplifyIntSIGXY.3,Goal) & ar(SimplifyIntSIGXY.12,Goal) & eh(THIS,THIS,Goal) & ah(THIS : dom(balanceOf)) & pr & dd & ah(THIS : dom({msg_sender|->balanceOf(msg_sender)-msg_value,THIS|->balanceOf(THIS)+msg_value})) & ss & pr & dd & ah((balanceOf<+{msg_sender|->balanceOf(msg_sender)-msg_value,THIS|->balanceOf(THIS)+msg_value})(THIS) = balanceOf(THIS)+msg_value) & ss & pr & dd & eh((balanceOf<+{msg_sender|->balanceOf(msg_sender)-msg_value,THIS|->balanceOf(THIS)+msg_value})(THIS),balanceOf(THIS)+msg_value,Goal) & ah(({msg_sender}<<|accountOf\/{msg_sender|->accountOf(msg_sender)+msg_value})(msg_sender) = accountOf(msg_sender)+msg_value) & ss & pr & dd & eh(({msg_sender}<<|accountOf\/{msg_sender|->accountOf(msg_sender)+msg_value})(msg_sender),accountOf(msg_sender)+msg_value,Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}\/{msg_sender}) & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}\/{msg_sender},Hyp(balanceOf(THIS) = SIGMA(ct).(ct : dom(accountOf) | accountOf(ct))+initial_balance)) & ar(s1.3,Goal) & dd & eh(balanceOf(THIS),SIGMA(ct).(ct : dom(accountOf)-{msg_sender} | accountOf(ct))+SIGMA(ct).(ct : {msg_sender} | accountOf(ct))+initial_balance,Goal) & pr;
Operation(transferFrom) & ff(0) & dd & ah(dom(accountOf<+{src|->accountOf(src)-amount,msg_sender|->accountOf(msg_sender)+amount}) = dom(accountOf)) & ss & pr & dd & eh(dom(accountOf<+{src|->accountOf(src)-amount,msg_sender|->accountOf(msg_sender)+amount}),dom(accountOf),Goal) & ah(accountOf<+{src|->accountOf(src)-amount,msg_sender|->accountOf(msg_sender)+amount} = accountOf<+{src|->accountOf(src)-amount}<+{msg_sender|->accountOf(msg_sender)+amount}) & ss & pr & dd & eh(accountOf<+{src|->accountOf(src)-amount,msg_sender|->accountOf(msg_sender)+amount},accountOf<+{src|->accountOf(src)-amount}<+{msg_sender|->accountOf(msg_sender)+amount},Goal) & ah(accountOf<+{src|->accountOf(src)-amount}<+{msg_sender|->accountOf(msg_sender)+amount} = {msg_sender}<<|(accountOf<+{src|->accountOf(src)-amount})\/{msg_sender|->accountOf(msg_sender)+amount}) & ar(b1.38,Once) & dd & eh(accountOf<+{src|->accountOf(src)-amount}<+{msg_sender|->accountOf(msg_sender)+amount},{msg_sender}<<|(accountOf<+{src|->accountOf(src)-amount})\/{msg_sender|->accountOf(msg_sender)+amount},Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}\/{msg_sender}) & ss & pr & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}\/{msg_sender},Goal) & ah(dom(accountOf)-{msg_sender}/\{msg_sender} = {}) & ss & pr & dd & ar(s1.3,Goal) & ah(msg_sender/:dom(accountOf)-{msg_sender}) & pr & dd & ah({msg_sender}<<|(accountOf<+{src|->accountOf(src)-amount}) : dom(accountOf)-{msg_sender} +-> NATURAL) & ar(SimplifyRelDoaLongXY.1,Goal) & ss & ar(InFunctionXY.14,Once) & pr & ah(ran({src,msg_sender}<<|accountOf) <: NAT & NAT <: NATURAL) & pr & pr & pr & pr & dd & ar(SimplifyIntSIGXY.3,Goal) & ar(SimplifyIntSIGXY.12,Goal) & ah(accountOf<+{src|->accountOf(src)-amount} = {src}<<|accountOf\/{src|->accountOf(src)-amount}) & ar(b1.38,Once) & dd & eh(accountOf<+{src|->accountOf(src)-amount},{src}<<|accountOf\/{src|->accountOf(src)-amount},Goal) & ar(SimplifyRelDoaLongXY.3,Goal) & ah({msg_sender}<<|{src|->accountOf(src)-amount} = {src|->accountOf(src)-amount}) & ss & pr & dd & eh({msg_sender}<<|{src|->accountOf(src)-amount},{src|->accountOf(src)-amount},Goal) & ah(dom(accountOf)-{msg_sender} = dom(accountOf)-{msg_sender}-{src}\/{src}) & ss & pr & dd & eh(dom(accountOf)-{msg_sender},dom(accountOf)-{msg_sender}-{src}\/{src},Goal) & ah(dom(accountOf)-{msg_sender}-{src}/\{src} = {}) & ss & pr & dd & ar(s1.3,Goal) & ar(SimplifyIntSIGXY.12,Goal) & ah(([ct:=src]({msg_sender}<<|({src}<<|accountOf)\/{src|->accountOf(src)-amount})(ct)) = accountOf(src)-amount) & ss & pr & dd & eh(([ct:=src]({msg_sender}<<|({src}<<|accountOf)\/{src|->accountOf(src)-amount})(ct)),accountOf(src)-amount,Goal) & ah({msg_sender}<<|({src}<<|accountOf) : dom(accountOf)-{msg_sender}-{src} +-> NATURAL) & ar(SimplifyRelDoaXY.16,Goal) & ar(InFunctionXY.10,Once) & pr & ah(NAT <: NATURAL) & pr & pr & dd & ah(src/:dom(accountOf)-{msg_sender}-{src}) & pr & dd & ar(SimplifyIntSIGXY.3,Goal) & ah(({msg_sender}<<|({src}<<|accountOf)\/{src|->accountOf(src)-amount}\/{msg_sender|->accountOf(msg_sender)+amount})(msg_sender) = accountOf(msg_sender)+amount) & ss & pr & dd & eh(({msg_sender}<<|({src}<<|accountOf)\/{src|->accountOf(src)-amount}\/{msg_sender|->accountOf(msg_sender)+amount})(msg_sender),accountOf(msg_sender)+amount,Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}-{src}\/{msg_sender,src}) & ah({msg_sender,src} <: dom(accountOf)) & pr & dd & ah(dom(accountOf)-{msg_sender}-{src} = dom(accountOf)-{msg_sender,src}) & ss & pr & dd & eh(dom(accountOf)-{msg_sender}-{src},dom(accountOf)-{msg_sender,src},Goal) & mp & ah({msg_sender,src} <: dom(accountOf)) & pr & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}-{src}\/{msg_sender,src},Hyp(balanceOf(THIS) = SIGMA(ct).(ct : dom(accountOf) | accountOf(ct))+initial_balance)) & eh(THIS,THIS,Goal) & dd & eh(balanceOf(THIS),SIGMA(ct).(ct : dom(accountOf)-{msg_sender}-{src}\/{msg_sender,src} | accountOf(ct))+initial_balance,Goal) & ah(dom(accountOf)-{msg_sender}-{src}/\{msg_sender,src} = {}) & ss & pr & dd & ar(s1.3,Goal) & ah({msg_sender}/\{src} = {}) & ss & pr & dd & ar(s1.3,Goal) & pr;
Operation(transferTo) & ff(0) & dd & ah(dom(accountOf<+{msg_sender|->accountOf(msg_sender)-amount,dst|->accountOf(dst)+amount}) = dom(accountOf)) & ss & pr & dd & eh(dom(accountOf<+{msg_sender|->accountOf(msg_sender)-amount,dst|->accountOf(dst)+amount}),dom(accountOf),Goal) & ah(accountOf<+{msg_sender|->accountOf(msg_sender)-amount,dst|->accountOf(dst)+amount} = accountOf<+{dst|->accountOf(dst)+amount}<+{msg_sender|->accountOf(msg_sender)-amount}) & mp & pr & pp(rp.0 | 60) & dd & eh(accountOf<+{msg_sender|->accountOf(msg_sender)-amount,dst|->accountOf(dst)+amount},accountOf<+{dst|->accountOf(dst)+amount}<+{msg_sender|->accountOf(msg_sender)-amount},Goal) & ah(accountOf<+{dst|->accountOf(dst)+amount} = {dst}<<|accountOf\/{dst|->accountOf(dst)+amount}) & ar(b1.38,Once) & dd & eh(accountOf<+{dst|->accountOf(dst)+amount},{dst}<<|accountOf\/{dst|->accountOf(dst)+amount},Goal) & ah({dst}<<|accountOf\/{dst|->accountOf(dst)+amount}<+{msg_sender|->accountOf(msg_sender)-amount} = {msg_sender}<<|({dst}<<|accountOf\/{dst|->accountOf(dst)+amount})\/{msg_sender|->accountOf(msg_sender)-amount}) & ar(b1.38,Once) & dd & eh({dst}<<|accountOf\/{dst|->accountOf(dst)+amount}<+{msg_sender|->accountOf(msg_sender)-amount},{msg_sender}<<|({dst}<<|accountOf\/{dst|->accountOf(dst)+amount})\/{msg_sender|->accountOf(msg_sender)-amount},Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}\/{msg_sender}) & ss & pr & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}\/{msg_sender},Goal) & ah(dom(accountOf)-{msg_sender}/\{msg_sender} = {}) & ss & pr & dd & ar(s1.3,Goal) & ar(SimplifyIntSIGXY.12,Goal) & ah({msg_sender}<<|({dst}<<|accountOf\/{dst|->accountOf(dst)+amount}) : dom(accountOf)-{msg_sender} +-> NATURAL) & ar(SimplifyRelDoaLongXY.3,Goal) & ar(InFunctionXY.12,Once) & ar(SimplifyRelDoaXY.16,Goal) & ar(InFunctionXY.10,Once) & pr & ah(NAT <: NATURAL) & pr & pr & pr & ss & pr & dd & ah(msg_sender/:dom(accountOf)-{msg_sender}) & pr & dd & ar(SimplifyIntSIGXY.3,Goal) & ah(dom(accountOf)-{msg_sender} = dom(accountOf)-{msg_sender}-{dst}\/{dst}) & ss & pr & dd & eh(dom(accountOf)-{msg_sender},dom(accountOf)-{msg_sender}-{dst}\/{dst},Goal) & ah(dom(accountOf)-{msg_sender}-{dst}/\{dst} = {}) & ss & pr & dd & ar(s1.3,Goal) & ar(SimplifyIntSIGXY.12,Goal) & ar(SimplifyRelDoaLongXY.3,Goal) & ah({msg_sender}<<|{dst|->accountOf(dst)+amount} = {dst|->accountOf(dst)+amount}) & ss & pr & dd & eh({msg_sender}<<|{dst|->accountOf(dst)+amount},{dst|->accountOf(dst)+amount},Goal) & ah({msg_sender}<<|({dst}<<|accountOf) : dom(accountOf)-{msg_sender}-{dst} +-> NATURAL) & ar(SimplifyRelDoaXY.16,Goal) & ar(InFunctionXY.10,Once) & pr & ah(NAT <: NATURAL) & pr & pr & dd & ah(dst/:dom(accountOf)-{msg_sender}-{dst}) & pr & dd & ar(SimplifyIntSIGXY.3,Goal) & ah(({msg_sender}<<|({dst}<<|accountOf)\/{dst|->accountOf(dst)+amount})(dst) = accountOf(dst)+amount) & ss & pr & dd & eh(({msg_sender}<<|({dst}<<|accountOf)\/{dst|->accountOf(dst)+amount})(dst),accountOf(dst)+amount,Goal) & eh(THIS,THIS,Goal) & ah(dom(accountOf) = dom(accountOf)-{msg_sender}-{dst}\/{msg_sender,dst}) & ah(dom(accountOf)-{msg_sender}-{dst} = dom(accountOf)-{msg_sender,dst}) & ss & pr & dd & eh(dom(accountOf)-{msg_sender}-{dst},dom(accountOf)-{msg_sender,dst},Goal) & ah({msg_sender,dst} <: dom(accountOf)) & pr & pr & dd & eh(dom(accountOf),dom(accountOf)-{msg_sender}-{dst}\/{msg_sender,dst},Hyp(balanceOf(THIS) = SIGMA(ct).(ct : dom(accountOf) | accountOf(ct))+initial_balance)) & dd & eh(balanceOf(THIS),SIGMA(ct).(ct : dom(accountOf)-{msg_sender}-{dst}\/{msg_sender,dst} | accountOf(ct))+initial_balance,Goal) & ah(dom(accountOf)-{msg_sender}-{dst}/\{msg_sender,dst} = {}) & pr & dd & ar(s1.3,Goal) & pr & ah({msg_sender}/\{dst} = {}) & ss & pr & dd & ar(s1.3,Goal) & ar(SimplifyIntSIGXY.12,Goal) & pr & dd & fh(not(msg_sender = dst)) & ss & eh(dst,msg_sender,Goal) & ss & pr & pr
END